{% extends 'layout.njk' %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{% set pageTitle = "Search result" %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <span class="govuk-caption-l">Showing results for</span>
      <div class="btms-heading-container">
        <h1 class="govuk-heading-l">{{ searchTerm }}</h1>
        <a class="govuk-link govuk-link--no-visited-state" href="/search">Search again</a>
      </div>
      <h2 class="govuk-heading-m">Customs declaration details</h1>
      {% include "./includes/declaration-filters.njk" %}
      {% for customsDeclaration in customsDeclarations %}
        {% set declarationSummaryHTML %}
          {% include "./includes/declaration-summary.njk" %}
        {% endset %}
        {% set declarationHTML %}
         {% include "./includes/declaration-html.njk" %}
        {% endset %}
        {{
          govukDetails({
            summaryHtml: declarationSummaryHTML,
            html: declarationHTML,
            open: customsDeclaration.open,
            classes: 'btms-details',
            attributes: {
              'aria-label': customsDeclaration.movementReferenceNumber
            }
          })
        }}
      {% else %}
        <p class="govuk-body">No customs declarations found.</p>
      {% endfor %}
      <h2 class="govuk-heading-m">IPAFFS notification (CHED) details</h2>
      {% include "./includes/notification-filters.njk" %}
      {% for preNotification in preNotifications %}
        {% set notificationSummaryHTML %}
          {% include "./includes/notification-summary.njk" %}
        {% endset %}
        {% set notificationHTML %}
          {% include "./includes/notification-html.njk" %}
        {% endset %}
        {{
          govukDetails({
            summaryHtml: notificationSummaryHTML,
            html: notificationHTML,
            open: preNotification.open,
            classes: 'btms-details',
            attributes: {
              'aria-label': preNotification.referenceNumber
            }
          })
        }}
      {% else %}
        <p class="govuk-body">No pre-notifications found.</p>
      {% endfor %}
    </div>
  </div>
{% endblock %}
{% block bodyEnd %}
  {{ super() }}
  <script>BTMS.filters()</script>
{% endblock %}
