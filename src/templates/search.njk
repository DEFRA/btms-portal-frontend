{% extends 'layout.njk' %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set errors = {
  "SEARCH_TERM_REQUIRED": "Enter an MRN, CHED or GMR",
  "SEARCH_TERM_INVALID": "Enter an MRN, CHED or GMR reference in the correct format",
  "SEARCH_TERM_NOT_FOUND": searchTerm ~ " cannot be found"
} %}

{% set pageTitle = "Search for an MRN, CHED or GMR" %}

{% set searchHint %}
  {% include "./includes/search-hint.njk" %}
{% endset %}
{% set searchButton %}
  {% include "./includes/button-search.njk" %}
{% endset %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <form id="search" class="btms-search-wrapper" action="/search">
        <h1 class="govuk-label-wrapper">
          <label class="govuk-label govuk-label--l" for="search-term">
            Search for an MRN, CHED or GMR
          </label>
        </h1>
        <div id="search-term-hint" class="govuk-hint govuk-body-s">
          <p class="govuk-body-s">For example:</p>
          <ul class="govuk-list govuk-body-s">
            <li>MRN, 24GB6T3HFCIZV1HAR9</li>
            <li>CHED, CHEDP.GB.2025.4433124 or GBCHD2025.4433124</li>
            <li>GMR, GMRA00002KW2</li>
          </ul>
        </div>
        {{
          govukInput({
            errorMessage: {
              text: errors[errorCode],
              id: 'searchError'
            } if isValid == false,
            id: "search-term",
            name: "searchTerm",
            spellcheck: false,
            formGroup: {
              afterInput: {
                html: searchButton
              }
            },
            value: searchTerm
          })
        }}
      </form>
    </div>
  </div>
{% endblock %}
{% block bodyEnd %}
  {{ super() }}
  <script nonce="{{ cspNonce }}">BTMS.initSearch()</script>
{% endblock %}
